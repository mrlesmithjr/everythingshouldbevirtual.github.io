---
layout: post
title: Ubuntu UTM Homebrew – Part 2 - Network Graphing
date: 2012-11-04 10:19:55.000000000 -05:00
type: post
published: true
status: publish
categories:
- Linux
- Security
- Ubuntu
- UTM
tags:
- linux
- ntop
- ntop source
- ubuntu
- ubuntu 12.04
- UTM
meta:
  _edit_last: '11'
  fb_social_plugin_settings_box_subscribe: default
  fb_social_plugin_settings_box_recommendations_bar: default
  _s2mail: 'yes'
  _jd_tweet_this: 'yes'
  _jd_twitter: "#title# #url# #ubuntu"
  al2fb_facebook_link_id: '1329619822_3882819752186'
  al2fb_facebook_link_time: '2012-11-04T15:19:58+00:00'
  al2fb_facebook_link_picture: post=http://everythingshouldbevirtual.com/wp-content/uploads/2012/11/10-12-26-300x167.png
  _wp_jd_wp: http://wp.me/p2C5rM-b5
  _wp_jd_target: http://wp.me/p2C5rM-b5
  _jd_wp_twitter: 'a:2:{i:0;s:82:"#ElRetardoLand Ubuntu UTM Homebrew Network Graphing
    http://wp.me/p2C5rM-b5 #ubuntu";i:1;s:95:"#ElRetardoLand Ubuntu UTM Homebrew –
    Part 2 - Network Graphing http://wp.me/p2C5rM-b5 #ubuntu";}'
  snapEdIT: '1'
  snapFB: s:161:"a:1:{i:0;a:4:{s:4:"doFB";s:1:"1";s:8:"PostType";s:1:"A";s:10:"AttachPost";s:1:"1";s:10:"SNAPformat";s:51:"New
    post (%TITLE%) has been published on %SITENAME%";}}";
  snapLI: s:160:"a:1:{i:0;a:4:{s:4:"doLI";s:1:"1";s:10:"AttachPost";s:1:"1";s:10:"SNAPformat";s:41:"New
    post has been published on %SITENAME%";s:11:"SNAPformatT";s:6:"&nbsp;";}}";
  snapSU: s:100:"a:1:{i:0;a:3:{s:4:"doSU";s:1:"1";s:7:"apSUCat";s:2:"IT";s:10:"SNAPformat";s:16:"%TITLE%
    - %TEXT%";}}";
  snapTW: 's:126:"a:1:{i:0;a:3:{s:4:"doTW";s:1:"1";s:10:"SNAPformat";s:42:"%TITLE%
    - %URL% #everythingshouldbevirtual";s:8:"attchImg";s:1:"0";}}";'
  _wp_rp_related_posts_query_result_cache_expiration: '1510273323'
  _wp_rp_related_posts_query_result_cache_6: a:12:{i:0;O:8:"stdClass":2:{s:7:"post_id";s:3:"699";s:5:"score";s:17:"424.9912203072575";}i:1;O:8:"stdClass":2:{s:7:"post_id";s:3:"668";s:5:"score";s:17:"136.3968430657703";}i:2;O:8:"stdClass":2:{s:7:"post_id";s:3:"729";s:5:"score";s:18:"126.03959136300246";}i:3;O:8:"stdClass":2:{s:7:"post_id";s:3:"878";s:5:"score";s:17:"125.1596887948451";}i:4;O:8:"stdClass":2:{s:7:"post_id";s:4:"1494";s:5:"score";s:17:"87.33578793604404";}i:5;O:8:"stdClass":2:{s:7:"post_id";s:4:"3289";s:5:"score";s:17:"83.61532971475862";}i:6;O:8:"stdClass":2:{s:7:"post_id";s:4:"1566";s:5:"score";s:16:"80.3588272642634";}i:7;O:8:"stdClass":2:{s:7:"post_id";s:4:"2586";s:5:"score";s:17:"74.15968892184773";}i:8;O:8:"stdClass":2:{s:7:"post_id";s:4:"1695";s:5:"score";s:17:"69.66642095694343";}i:9;O:8:"stdClass":2:{s:7:"post_id";s:4:"3249";s:5:"score";s:17:"62.86218063478901";}i:10;O:8:"stdClass":2:{s:7:"post_id";s:4:"7208";s:5:"score";s:18:"62.744100871351264";}i:11;O:8:"stdClass":2:{s:7:"post_id";s:4:"7243";s:5:"score";s:18:"59.557055956672784";}}
  _wp_rp_image: '3669'
  dsq_thread_id: '3347302204'
author:
  login: larry.e.smith.jr
  email: larry.e.smith.jr@gmail.com
  display_name: mrlesmithjr
  first_name: Larry
  last_name: Smith
---
<p>In <a title="http://everythingshouldbevirtual.com/ubuntu-utm-homebrew" href="http://everythingshouldbevirtual.com/ubuntu-utm-homebrew">this</a> previous post we setup the initial UTM (Unified Threat Management). In this quick guide we will be setting up network traffic graphing. We want to be able to see the types and amount of traffic flowing through our UTM in nice graphs. So we will be setting up <a title="http://www.ntop.org/" href="http://www.ntop.org/" target="_blank">NTOP</a> to do this. We will be building from the source code because the NTOP version that installs from apt-get in Ubuntu 12.04 runs for a short period of time and then crashes.</p>
<pre>sudo apt-get build-dep ntop
sudo apt-get install graphviz
cd /tmp
wget http://sourceforge.net/projects/ntop/files/ntop/Stable/ntop-5.0.1.tar.gz
tar zxvf ntop-5.0.1.tar.gz
cd ntop-5.0.1/
sudo ./autogen.sh
sudo make
sudo make install
sudo ldconfig
sudo useradd ntop
sudo chown -R ntop.ntop /usr/local/etc/ntop
sudo chown -R ntop.ntop /usr/local/share/ntop
sudo nano /usr/local/bin/start_ntop.sh
sudo ntop -i "br0" -d -L -u ntop --skip-version-check --use-syslog=daemon --set-admin-password={your_admin_password}
sudo chmod +x /usr/local/bin/start_ntop.sh
sudo nano /etc/rc.local</pre>
<p>**Add the following line at the bottom before the line exit 0**</p>
<pre>/usr/local/bin/start_ntop.sh &amp;</pre>
<p>Reboot your UTM or simply run</p>
<pre>sudo /etc/init.d/rc.local start</pre>
<p>Now you will have some nice graphs and be able to see the type and volume of traffic on your network.</p>
<p><a href="http://everythingshouldbevirtual.com/wp-content/uploads/2012/11/10-12-26.png"><img class="alignnone size-medium wp-image-690" title="10-12-26" alt="" src="{{ site.baseurl }}/assets/10-12-26-300x167.png" width="300" height="167" /></a></p>
<p><a href="http://everythingshouldbevirtual.com/wp-content/uploads/2012/11/10-12-09.png"><img class="alignnone size-medium wp-image-689" title="10-12-09" alt="" src="{{ site.baseurl }}/assets/10-12-09-300x210.png" width="300" height="210" /></a></p>
<p><a href="http://everythingshouldbevirtual.com/wp-content/uploads/2012/11/10-12-34.png"><img class="alignnone size-medium wp-image-688" title="10-12-34" alt="" src="{{ site.baseurl }}/assets/10-12-34-300x111.png" width="300" height="111" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
