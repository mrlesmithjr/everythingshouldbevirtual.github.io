---
layout: post
title: How to Secure Ubuntu 12.04
date: 2012-11-18 14:54:55.000000000 -05:00
type: post
published: true
status: publish
categories:
- Linux
- Security
- Ubuntu
tags:
- denyhosts
- fail2ban
- iptables
- linux
- psad
- tiger
- ubuntu
meta:
  _edit_last: '11'
  snapEdIT: '1'
  _s2mail: 'yes'
  snap_isAutoPosted: '1'
  snapFB: s:280:"a:1:{i:0;a:8:{s:13:"SNAPincludeFB";s:1:"1";s:8:"PostType";s:1:"A";s:10:"AttachPost";s:1:"1";s:10:"SNAPformat";s:41:"New
    post has been published on %SITENAME%";s:11:"isPrePosted";s:1:"1";s:8:"isPosted";s:1:"1";s:4:"pgID";s:31:"490878107607759_530947923600777";s:4:"doFB";s:1:"1";}}";
  snapLI: s:239:"a:1:{i:0;a:7:{s:13:"SNAPincludeLI";s:1:"1";s:10:"AttachPost";s:1:"1";s:10:"SNAPformat";s:41:"New
    post has been published on %SITENAME%";s:11:"isPrePosted";s:1:"1";s:8:"isPosted";s:1:"1";s:4:"doLI";s:1:"1";s:11:"SNAPformatT";s:6:"&nbsp;";}}";
  snapTW: s:178:"a:1:{i:0;a:6:{s:13:"SNAPincludeTW";s:1:"1";s:10:"SNAPformat";s:15:"%TITLE%
    - %URL%";s:11:"isPrePosted";s:1:"1";s:8:"isPosted";s:1:"1";s:4:"doTW";s:1:"1";s:8:"attchImg";s:1:"0";}}";
  _yoast_wpseo_linkdex: '66'
  _yoast_wpseo_focuskw: Secure Ubuntu
  snapSU: s:100:"a:1:{i:0;a:3:{s:4:"doSU";s:1:"1";s:7:"apSUCat";s:2:"IT";s:10:"SNAPformat";s:16:"%TITLE%
    - %TEXT%";}}";
  _wp_rp_related_posts_query_result_cache_expiration: '1509709121'
  _wp_rp_related_posts_query_result_cache_6: a:12:{i:0;O:8:"stdClass":2:{s:7:"post_id";s:3:"699";s:5:"score";s:18:"258.76114478110173";}i:1;O:8:"stdClass":2:{s:7:"post_id";s:3:"687";s:5:"score";s:17:"125.1596887948451";}i:2;O:8:"stdClass":2:{s:7:"post_id";s:3:"729";s:5:"score";s:18:"120.03134854872437";}i:3;O:8:"stdClass":2:{s:7:"post_id";s:3:"668";s:5:"score";s:17:"92.68767345452852";}i:4;O:8:"stdClass":2:{s:7:"post_id";s:4:"1566";s:5:"score";s:16:"85.1546178104121";}i:5;O:8:"stdClass":2:{s:7:"post_id";s:4:"3289";s:5:"score";s:17:"82.61734738316349";}i:6;O:8:"stdClass":2:{s:7:"post_id";s:4:"2646";s:5:"score";s:17:"72.47985341629845";}i:7;O:8:"stdClass":2:{s:7:"post_id";s:4:"2586";s:5:"score";s:17:"71.43171171518202";}i:8;O:8:"stdClass":2:{s:7:"post_id";s:4:"2254";s:5:"score";s:17:"64.60317278878793";}i:9;O:8:"stdClass":2:{s:7:"post_id";s:4:"3249";s:5:"score";s:18:"61.864198303193895";}i:10;O:8:"stdClass":2:{s:7:"post_id";s:4:"3214";s:5:"score";s:17:"61.79587059167181";}i:11;O:8:"stdClass":2:{s:7:"post_id";s:4:"7243";s:5:"score";s:18:"58.559073625077666";}}
  _wp_rp_image: empty
  dsq_thread_id: '3347505132'
author:
  login: larry.e.smith.jr
  email: larry.e.smith.jr@gmail.com
  display_name: mrlesmithjr
  first_name: Larry
  last_name: Smith
---
<p>This is just a list of a few tweaks and apps you can use to secure your Ubuntu 12.04 LTS system (These also apply to other versions of Ubuntu). These are definitely worth implementing on any system that may be accessible from the internet.</p>
<h1>1. Secured Shared Memory</h1>
<ul>
<li><span style="font-size: small;">By default /dev/shm is mounted as read/write and the default permissions allow execute on programs, and many times httpd is attacked this way. So let's secure this by making the following changes</span>
<ul>
<li><span style="font-size: small;"><em>sudo nano /etc/fstab</em></span></li>
<li><em><span style="font-size: small;">tmpfs /dev/shm tmpfs defaults,noexec,nosuid 0 0</span></em></li>
</ul>
</li>
<li><span style="font-size: small;">This will mount /dev/shm as read/write, but no execute and no permission to change the UID of a running program.</span></li>
</ul>
<h1>2. Harden SSH</h1>
<ul>
<li>The best way to secure SSH is to disable root login and change the standard port tcp/22 to another port number.</li>
<li>We can do this by the following.
<ul>
<li><em>sudo nano /etc/ssh/sshd_config</em></li>
<li><em>Port &lt;change to another port other than 22&gt;</em></li>
<li><em>PermitRootLogin no</em></li>
</ul>
</li>
<li>Restart sshd
<ul>
<li><em>sudo /etc/init.d/ssh restart</em></li>
</ul>
</li>
</ul>
<h1>3. Prevent IP Spoofing</h1>
<ul>
<li><em>sudo nano /etc/host.conf</em></li>
<li><em>nospoof on</em> (add this line to the end of the file)</li>
</ul>
<h1>4. Log scanner and banning suspicious hosts</h1>
<ul>
<li>Install DenyHosts and Fail2Ban
<ul>
<li><em>sudo apt-get install denyhosts fail2ban</em></li>
</ul>
</li>
<li><em>sudo nano /etc/denyhosts.conf</em></li>
<li>modify the mail settings as needed
<ul>
<li><em>sudo nano /etc/fail2ban/jail.conf</em>
<ul>
<li>Enable or disable the services you want to use by changing enabled = true or enabled=false</li>
<li>Also change the SSH port if you changed from the default port of 22 from the above section on hardening SSH</li>
</ul>
</li>
<li><em>sudo /etc/init.d/fail2ban restart</em></li>
</ul>
</li>
</ul>
<h1>5. IDS (Intrusion Detection System)</h1>
<ul>
<li>We will use <a href="http://www.cipherdyne.org/psad/index.html">PSAD</a> for Intrusion Detection
<ul>
<li><em>sudo apt-get install psad</em></li>
</ul>
</li>
<li>Create IPTables rules so PSAD will scan the logs
<ul>
<li><em>sudo iptables -A INPUT -j LOG</em></li>
<li><em>sudo iptables -A FORWARD -j LOG</em></li>
<li><em>sudo nano /etc/psad/psad.conf (</em><strong>Reference <a title="http://www.cipherdyne.org/psad/docs/config.html" href="http://www.cipherdyne.org/psad/docs/config.html" target="_blank">this</a> link for more settings that can be changed within the psad.conf file<em>)</em></strong>
<ul>
<li>change the following line <em>IPT_SYSLOG_FILE             /var/log/messages;</em> to <em>IPT_SYSLOG_FILE             /var/log/syslog;</em></li>
</ul>
</li>
</ul>
</li>
<li>Reload psad
<ul>
<li>s<em>udo psad -R &amp;&amp; sudo psad --sig-update &amp;&amp; sudo psad -H</em></li>
</ul>
</li>
</ul>
<h1>6. Rootkit checking tools</h1>
<ul>
<li>We will use <a href="http://www.chkrootkit.org/">chkrootkit</a> and <a href="http://rkhunter.sourceforge.net/">rkhunter</a>. Both of these tools can be used together.
<ul>
<li><em>sudo apt-get install chkrootkit rkhunter</em></li>
<li><em>sudo chkrootkit</em></li>
<li><em>sudo rkhunter --update</em></li>
<li><em>sudo rkhunter --propupd</em></li>
<li><em>sudo rkhunter --check</em></li>
</ul>
</li>
</ul>
<h1>7. Log analysis</h1>
<ul>
<li>We are going to use logwatch for this
<ul>
<li><em>sudo apt-get install logwatch libdate-manip-perl</em></li>
</ul>
</li>
<li>follow the steps <a title="https://help.ubuntu.com/community/Logwatch" href="https://help.ubuntu.com/community/Logwatch" target="_blank">here</a> to finish the installation of logwatch</li>
</ul>
<h1>8. System Audit Security</h1>
<ul>
<li>We will be using <a href="http://www.nongnu.org/tiger/">tiger</a> to do this.
<ul>
<li><em>sudo apt-get install tiger</em></li>
</ul>
</li>
</ul>
<div><em>Technorati Tags: <a href="http://technorati.com/tags/Linux" rel="tag">Linux</a>,<a href="http://technorati.com/tags/Ubuntu" rel="tag">Ubuntu</a>,<a href="http://technorati.com/tags/Security" rel="tag">Security</a></em></div>
