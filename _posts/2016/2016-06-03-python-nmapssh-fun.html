---
layout: post
title: Python - NMAP/SSH Fun
date: 2016-06-03 16:58:44.000000000 -04:00
type: post
published: true
status: publish
categories:
- Coding
- Python
tags:
- nmap
- python
meta:
  _snap_forceSURL: '2'
  _edit_last: '7644'
  snap_MYURL: ''
  snapEdIT: '1'
  snapDL: s:162:"a:1:{i:0;a:6:{s:2:"do";s:1:"1";s:10:"msgTFormat";s:7:"%TITLE%";s:9:"msgFormat";s:9:"%EXCERPT%";s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";s:0:"";s:4:"doDL";s:1:"1";}}";
  snapFB: s:298:"a:1:{i:0;a:10:{s:2:"do";s:1:"1";s:8:"postType";s:1:"A";s:10:"AttachPost";s:1:"1";s:10:"SNAPformat";s:51:"New
    post (%TITLE%) has been published on %SITENAME%";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";s:0:"";s:4:"doFB";s:1:"1";s:11:"isPrePosted";s:1:"1";}}";
  snapLI: s:290:"a:1:{i:0;a:10:{s:2:"do";s:1:"1";s:8:"postType";s:1:"A";s:10:"SNAPformat";s:41:"New
    post has been published on %SITENAME%";s:12:"liMsgFormatT";s:1:" ";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";s:0:"";s:4:"doLI";s:1:"1";s:11:"isPrePosted";s:1:"1";}}";
  snapSU: s:337:"a:1:{i:0;a:11:{s:2:"do";s:1:"1";s:9:"msgFormat";s:16:"%TITLE% - %TEXT%";s:5:"suCat";s:2:"IT";s:4:"nsfw";s:1:"0";s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";s:0:"";s:4:"doSU";s:1:"1";s:8:"isPosted";s:1:"1";s:4:"pgID";s:6:"70WzgG";s:7:"postURL";s:50:"http://www.stumbleupon.com/content/70WzgG/comments";s:5:"pDate";s:19:"2016-06-03
    20:58:56";}}";
  _s2mail: 'yes'
  wp_github_commits_page_fields: a:3:{s:15:"gc_widget_title";s:0:"";s:11:"github_user";s:0:"";s:11:"github_repo";s:0:"";}
  _yoast_wpseo_focuskw_text_input: Python - NMAP/SSH
  _yoast_wpseo_focuskw: Python - NMAP/SSH
  _yoast_wpseo_linkdex: '63'
  _yoast_wpseo_primary_category: '445'
  snap_isAutoPosted: '1'
  _wp_rp_related_posts_query_result_cache_expiration: '1511980988'
  _wp_rp_related_posts_query_result_cache_6: a:12:{i:0;O:8:"stdClass":2:{s:7:"post_id";s:4:"6367";s:5:"score";s:18:"122.54692943088065";}i:1;O:8:"stdClass":2:{s:7:"post_id";s:4:"7702";s:5:"score";s:17:"68.72594572557226";}i:2;O:8:"stdClass":2:{s:7:"post_id";s:4:"4619";s:5:"score";s:18:"19.062199689861714";}i:3;O:8:"stdClass":2:{s:7:"post_id";s:4:"7966";s:5:"score";s:18:"18.736019300168415";}i:4;O:8:"stdClass":2:{s:7:"post_id";s:4:"2242";s:5:"score";s:18:"17.268080950085682";}i:5;O:8:"stdClass":2:{s:7:"post_id";s:4:"5485";s:5:"score";s:18:"17.203127772600418";}i:6;O:8:"stdClass":2:{s:7:"post_id";s:4:"4648";s:5:"score";s:18:"16.066017166781403";}i:7;O:8:"stdClass":2:{s:7:"post_id";s:4:"3114";s:5:"score";s:16:"14.7062132591745";}i:8;O:8:"stdClass":2:{s:7:"post_id";s:4:"7363";s:5:"score";s:18:"14.033268785802624";}i:9;O:8:"stdClass":2:{s:7:"post_id";s:4:"4934";s:5:"score";s:18:"14.033268785802624";}i:10;O:8:"stdClass":2:{s:7:"post_id";s:4:"1494";s:5:"score";s:18:"13.884728928782373";}i:11;O:8:"stdClass":2:{s:7:"post_id";s:4:"3289";s:5:"score";s:18:"13.625444407146485";}}
  snapTW: 's:324:"a:1:{i:0;a:10:{s:2:"do";s:1:"1";s:10:"SNAPformat";s:50:"%TITLE%
    - %URL% #everythingshouldbevirtual #DevOPs";s:8:"attchImg";s:1:"0";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";s:4:"doTW";s:1:"1";s:11:"isPrePosted";s:1:"1";s:8:"isPosted";s:1:"1";s:4:"pgID";s:18:"738837393361379328";s:5:"pDate";s:19:"2016-06-03
    20:58:56";}}";'
  _wp_rp_image: empty
author:
  login: mrlesmithjr
  email: mrlesmithjr@gmail.com
  display_name: Larry Smith Jr.
  first_name: ''
  last_name: ''
---
<p style="text-align: center;"><strong>Python - NMAP/SSH Fun</strong></p>
<hr />
<p style="text-align: left;">I am currently working on some Ansible/Python project(s) <em>(More to come on that soon)</em> and am working on integrating some functionality between some of the moving components. One of them is scanning subnet(s) with NMAP and testing SSH access <em>(May not be the most efficient, but time will tell)</em> along with spitting out some JSON results. So I figured I would share the Python script that I am currently working on for this.</p>
<p>https://gist.github.com/mrlesmithjr/be08155018c47eb1ad9a4ae60da1713d</p>
<p>And if I were to run this against a subnet such as (Only scanning hosts for an SSH port)...</p>
<pre>nmap_fun.py 172.28.128.0/24 22 22 --sshuser vagrant --sshpass vagrant --testssh true
</pre>
<p>I would get the following results...Now I could easily use these results elsewhere :)</p>
<pre>{
    "hosts": {
        "172.28.128.11": {
            "scanned_ports": [
                {
                    "product": "OpenSSH", 
                    "state": "open", 
                    "port": 22, 
                    "name": "ssh"
                }
            ], 
            "host": "172.28.128.11", 
            "hostname": "Lookup failed", 
            "protocol": "tcp", 
            "ssh_connection_status": "Successful"
        }, 
        "172.28.128.10": {
            "scanned_ports": [
                {
                    "product": "OpenSSH", 
                    "state": "open", 
                    "port": 22, 
                    "name": "ssh"
                }
            ], 
            "host": "172.28.128.10", 
            "hostname": "Lookup failed", 
            "protocol": "tcp", 
            "ssh_connection_status": "Successful"
        }, 
        "172.28.128.13": {
            "scanned_ports": [
                {
                    "product": "OpenSSH", 
                    "state": "open", 
                    "port": 22, 
                    "name": "ssh"
                }
            ], 
            "host": "172.28.128.13", 
            "hostname": "Lookup failed", 
            "protocol": "tcp", 
            "ssh_connection_status": "Successful"
        }, 
        "172.28.128.12": {
            "scanned_ports": [
                {
                    "product": "OpenSSH", 
                    "state": "open", 
                    "port": 22, 
                    "name": "ssh"
                }
            ], 
            "host": "172.28.128.12", 
            "hostname": "Lookup failed", 
            "protocol": "tcp", 
            "ssh_connection_status": "Successful"
        }, 
        "172.28.128.9": {
            "scanned_ports": [
                {
                    "product": "OpenSSH", 
                    "state": "open", 
                    "port": 22, 
                    "name": "ssh"
                }
            ], 
            "host": "172.28.128.9", 
            "hostname": "Lookup failed", 
            "protocol": "tcp", 
            "ssh_connection_status": "Successful"
        }, 
        "172.28.128.1": {
            "scanned_ports": [
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 22, 
                    "name": "ssh"
                }
            ], 
            "host": "172.28.128.1", 
            "hostname": "Lookup failed", 
            "protocol": "tcp", 
            "ssh_connection_status": "Unable to Connect"
        }
    }
}
</pre>
<p>But maybe instead of checking for an SSH connection I would like to scan a subnet for the common ports defined in the Python script variable <em>common_ports</em> and return those results in JSON.</p>
<pre>nmap_fun.py 10.0.102.0/24
</pre>
<p>I would get some additional information in my JSON results..</p>
<pre>{
    "hosts": {
        "10.0.102.1": {
            "scanned_ports": [
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 21, 
                    "name": "ftp"
                }, 
                {
                    "product": "OpenSSH", 
                    "state": "open", 
                    "port": 22, 
                    "name": "ssh"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 23, 
                    "name": "telnet"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 25, 
                    "name": "smtp"
                }, 
                {
                    "product": "", 
                    "state": "open", 
                    "port": 53, 
                    "name": "domain"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 69, 
                    "name": "tftp"
                }, 
                {
                    "product": "nginx", 
                    "state": "open", 
                    "port": 80, 
                    "name": "http"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 109, 
                    "name": "pop2"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 110, 
                    "name": "pop3"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 123, 
                    "name": "ntp"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 137, 
                    "name": "netbios-ns"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 138, 
                    "name": "netbios-dgm"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 139, 
                    "name": "netbios-ssn"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 143, 
                    "name": "imap"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 156, 
                    "name": ""
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 389, 
                    "name": "ldap"
                }, 
                {
                    "product": "nginx", 
                    "state": "open", 
                    "port": 443, 
                    "name": "http"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 445, 
                    "name": "microsoft-ds"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 546, 
                    "name": ""
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 547, 
                    "name": ""
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 993, 
                    "name": "imaps"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 995, 
                    "name": "pop3s"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 3306, 
                    "name": "mysql"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 3389, 
                    "name": "ms-wbt-server"
                }
            ], 
            "host": "10.0.102.1", 
            "hostname": "Lookup failed", 
            "protocol": "tcp"
        }, 
        "10.0.102.129": {
            "scanned_ports": [
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 21, 
                    "name": "ftp"
                }, 
                {
                    "product": "OpenSSH", 
                    "state": "open", 
                    "port": 22, 
                    "name": "ssh"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 23, 
                    "name": "telnet"
                }, 
                {
                    "product": "Postfix smtpd", 
                    "state": "open", 
                    "port": 25, 
                    "name": "smtp"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 53, 
                    "name": "domain"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 69, 
                    "name": "tftp"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 80, 
                    "name": "http"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 109, 
                    "name": "pop2"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 110, 
                    "name": "pop3"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 123, 
                    "name": "ntp"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 137, 
                    "name": "netbios-ns"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 138, 
                    "name": "netbios-dgm"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 139, 
                    "name": "netbios-ssn"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 143, 
                    "name": "imap"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 156, 
                    "name": ""
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 389, 
                    "name": "ldap"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 443, 
                    "name": "https"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 445, 
                    "name": "microsoft-ds"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 546, 
                    "name": ""
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 547, 
                    "name": ""
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 993, 
                    "name": "imaps"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 995, 
                    "name": "pop3s"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 3306, 
                    "name": "mysql"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 3389, 
                    "name": "ms-wbt-server"
                }
            ], 
            "host": "10.0.102.129", 
            "hostname": "'ansible-control.etsbv.internal'", 
            "protocol": "tcp"
        }, 
        "10.0.102.128": {
            "scanned_ports": [
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 21, 
                    "name": "ftp"
                }, 
                {
                    "product": "OpenSSH", 
                    "state": "open", 
                    "port": 22, 
                    "name": "ssh"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 23, 
                    "name": "telnet"
                }, 
                {
                    "product": "Postfix smtpd", 
                    "state": "open", 
                    "port": 25, 
                    "name": "smtp"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 53, 
                    "name": "domain"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 69, 
                    "name": "tftp"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 80, 
                    "name": "http"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 109, 
                    "name": "pop2"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 110, 
                    "name": "pop3"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 123, 
                    "name": "ntp"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 137, 
                    "name": "netbios-ns"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 138, 
                    "name": "netbios-dgm"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 139, 
                    "name": "netbios-ssn"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 143, 
                    "name": "imap"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 156, 
                    "name": ""
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 389, 
                    "name": "ldap"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 443, 
                    "name": "https"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 445, 
                    "name": "microsoft-ds"
                }, 
                {
                    "product": "", 
                    "state": "filtered", 
                    "port": 546, 
                    "name": ""
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 547, 
                    "name": ""
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 993, 
                    "name": "imaps"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 995, 
                    "name": "pop3s"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 3306, 
                    "name": "mysql"
                }, 
                {
                    "product": "", 
                    "state": "closed", 
                    "port": 3389, 
                    "name": "ms-wbt-server"
                }
            ], 
            "host": "10.0.102.128", 
            "hostname": "'smtp.etsbv.internal'", 
            "protocol": "tcp"
        }
    }
}
</pre>
<p>So there you have it...Stay tuned for more on this and more...</p>
<p>Enjoy!</p>
