---
layout: post
title: Docker - Creating An Alpine Image With Ansible Installed
date: 2016-09-21 01:00:26.000000000 -04:00
type: post
published: true
status: publish
categories:
- Ansible
- Automation
- Docker
tags:
- Ansible
- Docker
meta:
  _edit_last: '7644'
  snapFB: s:298:"a:1:{i:0;a:10:{s:2:"do";s:1:"1";s:8:"postType";s:1:"A";s:10:"AttachPost";s:1:"1";s:10:"SNAPformat";s:51:"New
    post (%TITLE%) has been published on %SITENAME%";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";s:0:"";s:4:"doFB";s:1:"1";s:11:"isPrePosted";s:1:"1";}}";
  _snap_forceSURL: '2'
  snap_MYURL: ''
  snapEdIT: '1'
  snapDL: s:162:"a:1:{i:0;a:6:{s:2:"do";s:1:"1";s:10:"msgTFormat";s:7:"%TITLE%";s:9:"msgFormat";s:9:"%EXCERPT%";s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";s:0:"";s:4:"doDL";s:1:"1";}}";
  _yoast_wpseo_primary_category: '412'
  snapLI: s:290:"a:1:{i:0;a:10:{s:2:"do";s:1:"1";s:8:"postType";s:1:"A";s:10:"SNAPformat";s:41:"New
    post has been published on %SITENAME%";s:12:"liMsgFormatT";s:1:" ";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";s:0:"";s:4:"doLI";s:1:"1";s:11:"isPrePosted";s:1:"1";}}";
  snapSU: s:332:"a:1:{i:0;a:11:{s:2:"do";s:1:"1";s:9:"msgFormat";s:16:"%TITLE% - %TEXT%";s:5:"suCat";s:2:"IT";s:4:"nsfw";s:1:"0";s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";s:0:"";s:4:"doSU";s:1:"1";s:8:"isPosted";s:1:"1";s:4:"pgID";s:6:"2XEsUB";s:7:"postURL";s:45:"http://www.stumbleupon.com/su/2XEsUB/comments";s:5:"pDate";s:19:"2016-09-21
    05:00:35";}}";
  _s2mail: 'yes'
  catchbox-sidebarlayout: default
  wp_github_commits_page_fields: a:3:{s:15:"gc_widget_title";s:0:"";s:11:"github_user";s:0:"";s:11:"github_repo";s:0:"";}
  _yoast_wpseo_content_score: '60'
  _yoast_wpseo_focuskw_text_input: Docker - Creating An Alpine Image With Ansible
    Installed
  _wpcom_is_markdown: '1'
  _yoast_wpseo_focuskw: Docker - Creating An Alpine Image With Ansible Installed
  _yoast_wpseo_linkdex: '59'
  snap_isAutoPosted: '1'
  _wp_rp_related_posts_query_result_cache_expiration: '1510981288'
  _wp_rp_related_posts_query_result_cache_6: a:12:{i:0;O:8:"stdClass":2:{s:7:"post_id";s:4:"7064";s:5:"score";s:18:"107.02295960133327";}i:1;O:8:"stdClass":2:{s:7:"post_id";s:4:"6657";s:5:"score";s:17:"96.42705024988132";}i:2;O:8:"stdClass":2:{s:7:"post_id";s:4:"6912";s:5:"score";s:17:"78.48734813770088";}i:3;O:8:"stdClass":2:{s:7:"post_id";s:4:"5763";s:5:"score";s:17:"58.98849455128809";}i:4;O:8:"stdClass":2:{s:7:"post_id";s:4:"4648";s:5:"score";s:18:"54.232373687634365";}i:5;O:8:"stdClass":2:{s:7:"post_id";s:4:"4879";s:5:"score";s:17:"50.04734644136077";}i:6;O:8:"stdClass":2:{s:7:"post_id";s:4:"4449";s:5:"score";s:17:"50.04734644136077";}i:7;O:8:"stdClass":2:{s:7:"post_id";s:4:"4386";s:5:"score";s:18:"49.836625410058105";}i:8;O:8:"stdClass":2:{s:7:"post_id";s:4:"6225";s:5:"score";s:17:"47.16662327637265";}i:9;O:8:"stdClass":2:{s:7:"post_id";s:4:"5798";s:5:"score";s:17:"47.16662327637265";}i:10;O:8:"stdClass":2:{s:7:"post_id";s:4:"4944";s:5:"score";s:17:"47.16662327637265";}i:11;O:8:"stdClass":2:{s:7:"post_id";s:4:"4695";s:5:"score";s:17:"47.16662327637265";}}
  snapTW: 's:333:"a:1:{i:0;a:10:{s:2:"do";s:1:"1";s:10:"SNAPformat";s:59:"%TITLE%
    - %URL% #everythingshouldbevirtual #Docker #ansible";s:8:"attchImg";s:1:"0";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";s:4:"doTW";s:1:"1";s:11:"isPrePosted";s:1:"1";s:8:"isPosted";s:1:"1";s:4:"pgID";s:18:"778458883312357384";s:5:"pDate";s:19:"2016-09-21
    05:00:35";}}";'
  _wp_rp_image: empty
author:
  login: mrlesmithjr
  email: mrlesmithjr@gmail.com
  display_name: Larry Smith Jr.
  first_name: ''
  last_name: ''
---
<p style="text-align: center;"><strong>Docker - Creating An Alpine Image With Ansible Installed</strong></p>
<hr />
<p>As I am experimenting with <a href="&lt;https://www.docker.com&gt;">Docker</a> images and finding the right combination<br />
which works well for me the majority of the time. I have finally put together<br />
a simple <code>Dockerfile</code> which uses <a href="&lt;http://alpinelinux.org/&gt;">Alpine</a> Linux as the base image and installs<br />
<a href="&lt;https://www.ansible.com/&gt;">Ansible</a>. Why <a href="&lt;https://www.ansible.com/&gt;">Ansible</a> in a <a href="&lt;https://www.docker.com&gt;">Docker</a> image? Because for me it allows me to<br />
get around <code>BASH</code> and use a desired state methodology. Now this may not be for<br />
everyone but it works really well for me. Especially when I am using this base<br />
image to do additional complex configuration either during the image creation<br />
or during the spin-up of a container which may require custom provisioning. So,<br />
with this all being said you will find the very simple <code>Dockerfile</code> below which<br />
will install <a href="&lt;https://www.ansible.com/&gt;">Ansible</a> for us.</p>
<p><code>Dockerfile</code></p>
<pre><code>FROM alpine:3.4

MAINTAINER Larry Smith Jr. &lt;mrlesmithjr@gmail.com&gt;

RUN apk update &amp;&amp; \
apk add --no-cache ansible &amp;&amp; \
rm -rf /tmp/* &amp;&amp; \
rm -rf /var/cache/apk/*
</code></pre>
<p>To build your image simply create the <code>Dockerfile</code> above and then build the<br />
image:</p>
<pre><code>docker build -t alpine-ansible .
</code></pre>
<p>So why <a href="&lt;http://alpinelinux.org/&gt;">Alpine</a> Linux? Because it is small... How small? Let's compare a few<br />
base images.</p>
<p><code>Ubuntu 14.04</code></p>
<pre><code>ubuntu 14.04 b1719e1db756 34 hours ago 188 MB
</code></pre>
<p><code>Ubuntu 16.04</code></p>
<pre><code>ubuntu 16.04 45bc58500fa3 34 hours ago 126.9 MB
</code></pre>
<p><code>Debian Jessie</code></p>
<pre><code>debian jessie a24c3183e910 33 hours ago 123 MB
</code></pre>
<p><code>Alpine 3.4</code></p>
<pre><code>alpine 3.4 7d23b3ca3463 28 hours ago 4.799 MB
</code></pre>
<p>Now let's look at what a <a href="&lt;http://www.ubuntu.com/&gt;">Ubuntu</a> image looks like with <a href="&lt;https://www.ansible.com/&gt;">Ansible</a> installed:</p>
<pre><code>mrlesmithjr/ubuntu-ansible latest 69c2195ca7d7 31 hours ago 242.2 MB
</code></pre>
<p>As you can see, installing <a href="&lt;https://www.ansible.com/&gt;">Ansible</a> added about <code>~120MB</code> to our base image. Now<br />
let's see what an <a href="&lt;http://alpinelinux.org/&gt;">Alpine</a> image looks like with <a href="&lt;https://www.ansible.com/&gt;">Ansible</a> installed:</p>
<pre><code>mrlesmithjr/alpine-ansible latest 5291ba47263e 26 hours ago 65.01 MB
</code></pre>
<p>Wow...We have only increased our <a href="&lt;http://alpinelinux.org/&gt;">Alpine</a> base image by <code>~60MB</code>... This cuts<br />
out almost half of the size of even a [Debian] or <a href="&lt;http://www.ubuntu.com/&gt;">Ubuntu</a> base image.</p>
<p>So there you have it...</p>
<p>Now you can leverage my pre-build <a href="&lt;http://alpinelinux.org/&gt;">Alpine</a> image with <a href="&lt;https://www.ansible.com/&gt;">Ansible</a> installed in a<br />
new <code>Dockerfile</code> to create a new image for another app:</p>
<p><code>Dockerfile</code></p>
<pre><code>FROM mrlesmithjr/alpine-ansible

...
</code></pre>
<p>Or, even build your own image now.</p>
<p>I will be creating another post in the near future on how to build additional<br />
images for apps which will leverage this <a href="&lt;http://alpinelinux.org/&gt;">Alpine</a> image with <a href="&lt;https://www.ansible.com/&gt;">Ansible</a>.</p>
<p>Enjoy!</p>
