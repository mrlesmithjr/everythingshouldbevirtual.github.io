---
layout: post
title: Building an OpenStack Virtual Lab
date: 
type: post
published: false
status: draft
categories: []
tags: []
meta:
  _edit_last: '11'
  snap_MYURL: ''
  snapEdIT: '1'
  snapDL: s:102:"a:1:{i:0;a:3:{s:4:"doDL";s:1:"1";s:11:"SNAPformatT";s:7:"%TITLE%";s:10:"SNAPformat";s:9:"%EXCERPT%";}}";
  snapFB: s:253:"a:1:{i:0;a:8:{s:4:"doFB";s:1:"1";s:8:"postType";s:1:"A";s:10:"AttachPost";s:1:"1";s:10:"SNAPformat";s:51:"New
    post (%TITLE%) has been published on %SITENAME%";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";s:0:"";}}";
  snapLI: s:246:"a:1:{i:0;a:8:{s:4:"doLI";s:1:"1";s:10:"AttachPost";s:1:"1";s:10:"SNAPformat";s:41:"New
    post has been published on %SITENAME%";s:11:"SNAPformatT";s:0:"";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";s:0:"";}}";
  snapSU: s:119:"a:1:{i:0;a:4:{s:4:"doSU";s:1:"1";s:7:"apSUCat";s:2:"IT";s:4:"nsfw";s:1:"0";s:10:"SNAPformat";s:16:"%TITLE%
    - %TEXT%";}}";
  snapTW: 's:172:"a:1:{i:0;a:5:{s:4:"doTW";s:1:"1";s:10:"SNAPformat";s:42:"%TITLE%
    - %URL% #everythingshouldbevirtual";s:8:"attchImg";s:1:"0";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";}}";'
  _s2mail: 'yes'
author:
  login: larry.e.smith.jr
  email: larry.e.smith.jr@gmail.com
  display_name: mrlesmithjr
  first_name: Larry
  last_name: Smith
---
<h4>Building an OpenStack Virtual Lab</h4>
<p>In this setup we will be using Virtualbox to build our VMs to do some initial setup and testing of OpenStack.</p>
<p>Build VMs (Ubuntu 14.04 LTS)</p>
<p>Controller Node (10.20.20.11)<br />
Network Node (10.20.20.21)<br />
Compute Node (10.20.20.31)</p>
<p>Gateway Node (Used for gateway services from management to internet) **Optional**</p>
<ul>
<li>After building the gateway node we need to enable IP forwarding and Masquerading.</li>
<li>
<pre>sudo nano /etc/sysctl.conf</pre>
</li>
<li>Uncomment the following line.</li>
<li>
<pre>#net.ipv4.ip_forward=1</pre>
</li>
<li>So it should look like below</li>
<li>
<pre>net.ipv4.ip_forward=1</pre>
</li>
<li>Now we need to setup our masquerading rule.</li>
<li>
<pre>sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</pre>
</li>
<li>In order to save our IPTables rules and apply them upon a reboot install iptables-persistent.</li>
<li>
<pre>sudo apt-get install iptables-persistent</pre>
</li>
<li>And select yes to save our current set of rules of IPv4 and IPv6.</li>
</ul>
<p>Adding OpenStack Repositories</p>
<pre>sudo bash
apt-get install ubuntu-cloud-keyring
echo "deb http://ubuntu-cloud.archive.canonical.com/ubuntu" \
  "trusty-updates/juno main" &gt; /etc/apt/sources.list.d/cloudarchive-juno.list
</pre>
<pre>apt-get update &amp;&amp; apt-get dist-upgrade</pre>
<p>Controller Node setup<br />
Setup Database.</p>
<pre>apt-get install mariadb-server python-mysqldb</pre>
<p>Enter a password for the MariaDB "root" user:</p>
<p>Modify /etc/mysql/my.cnf</p>
<pre>sudo nano /etc/mysql/my.cnf</pre>
<p>Under [mysqld] make the following changes<br />
comment out bind-address = 127.0.0.1 and add the following</p>
<pre>#bind-address           = 127.0.0.1
# Start of OpenStack Modifications
bind-address    = 10.20.20.11
default-storage-engine = innodb
innodb_file_per_table
collation-server = utf8_general_ci
init-connect = 'SET NAMES utf8'
character-set-server = utf8
# End of OpenStack Modifications</pre>
<p>Restart mysql</p>
<pre>sudo service mysql restart</pre>
<p>For message brokering between services we will be install RabbitMQ on the controller node.</p>
<pre>apt-get install rabbitmq-server</pre>
<p>Now let's change the default password (guest) for the default username (guest) to something more secure</p>
<pre>rabbitmqctl change_password guest new_password</pre>
<p>You will need to remember this password to install all OpenStack services so make sure to keep track of this.</p>
<p>Now it is time to setup the Identity service</p>
<pre>mysql -u root -p</pre>
