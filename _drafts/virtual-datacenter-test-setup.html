---
layout: post
title: Virtual DataCenter Test Setup
date: 
type: post
published: false
status: draft
categories: []
tags: []
meta:
  _edit_last: '11'
  fb_social_plugin_settings_box_subscribe: default
  _jd_tweet_this: 'yes'
author:
  login: larry.e.smith.jr
  email: larry.e.smith.jr@gmail.com
  display_name: mrlesmithjr
  first_name: Larry
  last_name: Smith
---
<p>P4000 vMSC setup recommendation is <a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=2020097" target="_blank">here</a>.</p>
<p>OpenVPN</p>
<p>Create tunnel between PFsense Firewalls</p>
<p>PFsense</p>
<p>To completely disable NAT to have a routing-only firewall, do the following.</p>
<ol>
<li>Go to the Firewall -&gt; NAT page, and click the Outbound tab.</li>
<li>Select the option "Manual Outbound NAT rule generation (Advanced Outbound NAT (AON))" and click Save.</li>
<li>Remove all automatically generated NAT rules at the bottom of the screen.</li>
<li>Apply changes</li>
</ol>
<p>You can NAT on some interfaces and not others by configuring your Outbound NAT rules accordingly.</p>
<p>To completely disable NAT and all firewall function from all interfaces, do the following. Note that you will skip the previous section ("Disable NAT") when taking this approach.</p>
<ol>
<li>Go to the System: Advanced page and click the Firewall / NAT tab.</li>
<li>Check the box to "Disable Firewall / Disable all packet filtering."</li>
<li>Save changes.</li>
</ol>
<p>Create static routes on each firewall for the opposite DC subnets.</p>
<p>&nbsp;</p>
<h3>VMware on Linux: Promiscuous Mode</h3>
<div></div>
<div id="post-body-776160102063023273">When VMware Workstation is hosted under Linux, by default it doesn't allow VM Guests to access the network in Promiscuous mode.  There's an easy fix for this...<br />
<a name="more"></a><br />
If you run something like Wireshark from a VM Guest, you'll see VMware display an error message.The problem lies with the permissions on the Host.  When VMware is started without root privileges, it doesn't have the permissions necessary to access the /dev/vmnet0 device.A quick temporary bodge is to use chgrp and chmod on the Host, to tweak the permissions on /dev/vmnet* until the next reboot (where yourgroup is a group that your user account is in - typically adminon my Ubuntu machines):<br />
chgrp yourgroup /dev/vmnet*<br />
chmod g+rw /dev/vmnet*</p>
<p>A more permanent fix is to edit /etc/init.d/vmware on the Host, and tweak the ownership and permissions when the device is created, by adding the lines in red:<br />
# Start the virtual ethernet kernel service<br />
vmwareStartVmnet() {<br />
vmwareLoadModule $vnet<br />
"$BINDIR"/vmware-networks --start &gt;&gt; $VNETLIB_LOG 2&gt;&amp;1<br />
chgrp yourgroup  /dev/vmnet*<br />
chmod g+rw /dev/vmnet*</p>
<div>After you restart the Host's VMware daemon .../etc/init.d/vmware stop<br />
/etc/init.d/vmware start</div>
</div>
<p>&nbsp;</p>
