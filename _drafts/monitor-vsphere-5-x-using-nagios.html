---
layout: post
title: Monitor vSphere 5.x using Nagios
date: 
type: post
published: false
status: draft
categories: []
tags: []
meta:
  snapEdIT: '1'
  _edit_last: '11'
  snap_MYURL: ''
  snapFB: s:247:"a:1:{i:0;a:8:{s:4:"doFB";s:1:"1";s:8:"PostType";s:1:"A";s:10:"AttachPost";s:1:"1";s:10:"SNAPformat";s:51:"New
    post (%TITLE%) has been published on %SITENAME%";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";b:0;s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";b:0;}}";
  snapLI: s:237:"a:1:{i:0;a:8:{s:4:"doLI";s:1:"1";s:10:"AttachPost";s:1:"1";s:10:"SNAPformat";s:41:"New
    post has been published on %SITENAME%";s:11:"SNAPformatT";b:0;s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";b:0;s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";b:0;}}";
  snapSU: s:119:"a:1:{i:0;a:4:{s:4:"doSU";s:1:"1";s:7:"apSUCat";s:2:"IT";s:4:"nsfw";s:1:"0";s:10:"SNAPformat";s:16:"%TITLE%
    - %TEXT%";}}";
  snapTW: 's:169:"a:1:{i:0;a:5:{s:4:"doTW";s:1:"1";s:10:"SNAPformat";s:42:"%TITLE%
    - %URL% #everythingshouldbevirtual";s:8:"attchImg";s:1:"0";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";b:0;}}";'
  _s2mail: 'yes'
author:
  login: larry.e.smith.jr
  email: larry.e.smith.jr@gmail.com
  display_name: mrlesmithjr
  first_name: Larry
  last_name: Smith
---
<pre>sudo apt-get install libxml2-dev uuid-dev libarchive-zip-perl libcrypt-ssleay-perl libclass-methodmaker-perl libdata-dump-perl libsoap-lite-perl perl-doc libssl-dev libuuid-perl liburi-perl libxml-libxml-perl ia32-libs
cd /opt
sudo wget http://search.cpan.org/CPAN/authors/id/J/JN/JNH/UUID-0.04.tar.gz
sudo tar zxvf UUID-0.04.tar.gz
cd UUID-0.04
sudo perl Makefile.PL</pre>
<p>Download the VMware Perl SDK from <a title="https://my.vmware.com/group/vmware/details?downloadGroup=VSP510-SDKPERL-510&amp;productId=285" href="https://my.vmware.com/group/vmware/details?downloadGroup=VSP510-SDKPERL-510&amp;productId=285" target="_blank">here</a> and copy it over to your Nagios server to /opt</p>
<pre>sudo bash
tar zxvf VMware-vSphere-Perl-SDK-5.1.0-780721.x86_64.tar.gz
cd vmware-vsphere-cli-distrib/
export http_proxy=
export ftp_proxy=
echo ubuntu &gt; /etc/tmp-release
./vmware-install.pl</pre>
<p>Select defaults during install and everything should install correctly.<br />
Now we need to disable https certificate checking.</p>
<pre>sudo sed -i -e 's|= 1;|= 0;|' /usr/share/perl5/LWP/Protocol/https.pm</pre>
<p>Grab check_esx.pl</p>
<pre>perl -MCPAN -e 'install Nagios::Plugin'
./check_esx -H esxi01 -u root -p password -l runtime -s status</pre>
